{"version":3,"file":"index.es.js","sources":["../src/useFps.ts","../src/useStyles.ts","../src/FpsView.tsx"],"sourcesContent":["import {useEffect, useRef, useState} from \"react\";\n\nexport default function useFps(windowWidth: number) {\n  const lastFpsValues = useRef<number[]>([]);\n  const frames = useRef(0);\n  const prevTime = useRef(performance.now());\n  const animRef = useRef(0);\n  const [fps, setFps] = useState<number[]>([]);\n\n  const calcFps = () => {\n    const t = performance.now();\n\n    frames.current += 1;\n\n    if (t > prevTime.current + 1000) {\n      const elapsedTime = t - prevTime.current;\n\n      const currentFps = Math.round((frames.current * 1000) / elapsedTime);\n\n      lastFpsValues.current = lastFpsValues.current.concat(currentFps);\n\n      if (elapsedTime > 1500) {\n        for (let i = 1; i <= (elapsedTime - 1000) / 1000; i++) {\n          lastFpsValues.current = lastFpsValues.current.concat(0);\n        }\n      }\n\n      lastFpsValues.current = lastFpsValues.current.slice(Math.min(lastFpsValues.current.length - windowWidth, 0));\n\n      setFps(lastFpsValues.current);\n\n      frames.current = 0;\n      prevTime.current = performance.now();\n    }\n\n    animRef.current = requestAnimationFrame(calcFps);\n  };\n\n  useEffect(() => {\n    animRef.current = requestAnimationFrame(calcFps);\n\n    return () => {\n      cancelAnimationFrame(animRef.current);\n    }\n  }, []);\n\n  const avgFps = (fps.reduce((a,b) => a + b, 0) / fps.length).toFixed(2);\n  const maxFps = Math.max.apply(Math.max, fps);\n  const currentFps = fps[fps.length - 1];\n\n  return {fps, avgFps, maxFps, currentFps};\n}","import {useCallback, useMemo} from \"react\";\n\ntype CssProp = number | string;\n\nexport default function useStyles(width: number, height: number, top: CssProp, right: CssProp, bottom: CssProp, left: CssProp, fpsLength: number) {\n  const wrapperStyle = useMemo(() => ({\n    zIndex: 999999,\n    position: 'fixed',\n    width: width + 6 + 'px',\n    height: height + 30 + 'px',\n    padding: '3px',\n    backgroundColor: '#21006f',\n    color: '#26F0FD',\n    fontSize: '1rem',\n    lineHeight: '1.3rem',\n    fontFamily: 'Helvetica, Arial, sans-serif',\n    fontWeight: 300,\n    boxSizing: 'border-box',\n    top,\n    right,\n    bottom,\n    left,\n  }), [width, height, top, right, bottom, left]);\n\n  const graphStyle = useMemo(() => ({\n    position: 'absolute',\n    left: '3px',\n    right: '3px',\n    bottom: '3px',\n    height,\n    backgroundColor: '#282844',\n    MozBoxSizing: 'border-box',\n    boxSizing: 'border-box'\n  }), [height]);\n\n  const barStyle = useCallback((calcHeight, i) => ({\n    position: 'absolute',\n    bottom: '0',\n    right: ((fpsLength - 1 - i) * 4) + 'px',\n    height: calcHeight + 'px',\n    width: '4px',\n    backgroundColor: '#E200F7',\n    MozBoxSizing: 'border-box',\n    boxSizing: 'border-box'\n  }), [fpsLength]);\n\n  return {wrapperStyle, graphStyle, barStyle};\n}","import React from \"react\";\nimport useFps from \"./useFps\";\nimport useStyles from \"./useStyles\";\n\ninterface ComponentProps {\n  width?: number;\n  height?: number;\n  top?: number | string;\n  left?: number | string;\n  bottom?: number | string;\n  right?: number | string;\n}\n\nconst FpsView: React.FC<ComponentProps> = ({top = 0, left = 0, bottom = 'auto', right = 'auto', width = 140, height = 60}) => {\n  const {fps, avgFps, maxFps, currentFps} = useFps(Math.floor(width / 2));\n  const {graphStyle, barStyle, wrapperStyle} = useStyles(width, height, top, right, bottom, left, fps.length);\n\n  return (\n    // @ts-ignore\n    <div style={wrapperStyle}>\n      <span>{currentFps} FPS ({avgFps} Avg)</span>\n      {/* @ts-ignore */}\n      <div style={graphStyle}>\n        {fps.map((val, i) => (\n          // @ts-ignore\n          <div key={i} style={barStyle((height * val) / maxFps, i)}/>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default FpsView;\n"],"names":[],"mappings":";;SAEwB,MAAM,CAAC,WAAmB;IAChD,IAAM,aAAa,GAAG,MAAM,CAAW,EAAE,CAAC,CAAC;IAC3C,IAAM,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;IACzB,IAAM,QAAQ,GAAG,MAAM,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IAC3C,IAAM,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;IACpB,IAAA,KAAgB,QAAQ,CAAW,EAAE,CAAC,EAArC,GAAG,QAAA,EAAE,MAAM,QAA0B,CAAC;IAE7C,IAAM,OAAO,GAAG;QACd,IAAM,CAAC,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;QAE5B,MAAM,CAAC,OAAO,IAAI,CAAC,CAAC;QAEpB,IAAI,CAAC,GAAG,QAAQ,CAAC,OAAO,GAAG,IAAI,EAAE;YAC/B,IAAM,WAAW,GAAG,CAAC,GAAG,QAAQ,CAAC,OAAO,CAAC;YAEzC,IAAM,YAAU,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,IAAI,WAAW,CAAC,CAAC;YAErE,aAAa,CAAC,OAAO,GAAG,aAAa,CAAC,OAAO,CAAC,MAAM,CAAC,YAAU,CAAC,CAAC;YAEjE,IAAI,WAAW,GAAG,IAAI,EAAE;gBACtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,WAAW,GAAG,IAAI,IAAI,IAAI,EAAE,CAAC,EAAE,EAAE;oBACrD,aAAa,CAAC,OAAO,GAAG,aAAa,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;iBACzD;aACF;YAED,aAAa,CAAC,OAAO,GAAG,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,GAAG,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;YAE7G,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;YAE9B,MAAM,CAAC,OAAO,GAAG,CAAC,CAAC;YACnB,QAAQ,CAAC,OAAO,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;SACtC;QAED,OAAO,CAAC,OAAO,GAAG,qBAAqB,CAAC,OAAO,CAAC,CAAC;KAClD,CAAC;IAEF,SAAS,CAAC;QACR,OAAO,CAAC,OAAO,GAAG,qBAAqB,CAAC,OAAO,CAAC,CAAC;QAEjD,OAAO;YACL,oBAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;SACvC,CAAA;KACF,EAAE,EAAE,CAAC,CAAC;IAEP,IAAM,MAAM,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,UAAC,CAAC,EAAC,CAAC,IAAK,OAAA,CAAC,GAAG,CAAC,GAAA,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;IACvE,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;IAC7C,IAAM,UAAU,GAAG,GAAG,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAEvC,OAAO,EAAC,GAAG,KAAA,EAAE,MAAM,QAAA,EAAE,MAAM,QAAA,EAAE,UAAU,YAAA,EAAC,CAAC;AAC3C;;SC/CwB,SAAS,CAAC,KAAa,EAAE,MAAc,EAAE,GAAY,EAAE,KAAc,EAAE,MAAe,EAAE,IAAa,EAAE,SAAiB;IAC9I,IAAM,YAAY,GAAG,OAAO,CAAC,cAAM,QAAC;QAClC,MAAM,EAAE,MAAM;QACd,QAAQ,EAAE,OAAO;QACjB,KAAK,EAAE,KAAK,GAAG,CAAC,GAAG,IAAI;QACvB,MAAM,EAAE,MAAM,GAAG,EAAE,GAAG,IAAI;QAC1B,OAAO,EAAE,KAAK;QACd,eAAe,EAAE,SAAS;QAC1B,KAAK,EAAE,SAAS;QAChB,QAAQ,EAAE,MAAM;QAChB,UAAU,EAAE,QAAQ;QACpB,UAAU,EAAE,8BAA8B;QAC1C,UAAU,EAAE,GAAG;QACf,SAAS,EAAE,YAAY;QACvB,GAAG,KAAA;QACH,KAAK,OAAA;QACL,MAAM,QAAA;QACN,IAAI,MAAA;KACL,IAAC,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;IAE/C,IAAM,UAAU,GAAG,OAAO,CAAC,cAAM,QAAC;QAChC,QAAQ,EAAE,UAAU;QACpB,IAAI,EAAE,KAAK;QACX,KAAK,EAAE,KAAK;QACZ,MAAM,EAAE,KAAK;QACb,MAAM,QAAA;QACN,eAAe,EAAE,SAAS;QAC1B,YAAY,EAAE,YAAY;QAC1B,SAAS,EAAE,YAAY;KACxB,IAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;IAEd,IAAM,QAAQ,GAAG,WAAW,CAAC,UAAC,UAAU,EAAE,CAAC,IAAK,QAAC;QAC/C,QAAQ,EAAE,UAAU;QACpB,MAAM,EAAE,GAAG;QACX,KAAK,EAAE,CAAC,CAAC,SAAS,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI;QACvC,MAAM,EAAE,UAAU,GAAG,IAAI;QACzB,KAAK,EAAE,KAAK;QACZ,eAAe,EAAE,SAAS;QAC1B,YAAY,EAAE,YAAY;QAC1B,SAAS,EAAE,YAAY;KACxB,IAAC,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC;IAEjB,OAAO,EAAC,YAAY,cAAA,EAAE,UAAU,YAAA,EAAE,QAAQ,UAAA,EAAC,CAAC;AAC9C;;IClCM,OAAO,GAA6B,UAAC,EAA8E;QAA7E,WAAO,EAAP,GAAG,mBAAG,CAAC,KAAA,EAAE,YAAQ,EAAR,IAAI,mBAAG,CAAC,KAAA,EAAE,cAAe,EAAf,MAAM,mBAAG,MAAM,KAAA,EAAE,aAAc,EAAd,KAAK,mBAAG,MAAM,KAAA,EAAE,aAAW,EAAX,KAAK,mBAAG,GAAG,KAAA,EAAE,cAAW,EAAX,MAAM,mBAAG,EAAE,KAAA;IAChH,IAAA,KAAoC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,EAAhE,GAAG,SAAA,EAAE,MAAM,YAAA,EAAE,MAAM,YAAA,EAAE,UAAU,gBAAiC,CAAC;IAClE,IAAA,KAAuC,SAAS,CAAC,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,CAAC,MAAM,CAAC,EAApG,UAAU,gBAAA,EAAE,QAAQ,cAAA,EAAE,YAAY,kBAAkE,CAAC;IAE5G;;IAEE,6BAAK,KAAK,EAAE,YAAY;QACtB;YAAO,UAAU;;YAAQ,MAAM;oBAAa;QAE5C,6BAAK,KAAK,EAAE,UAAU,IACnB,GAAG,CAAC,GAAG,CAAC,UAAC,GAAG,EAAE,CAAC,IAAK;;QAEnB,6BAAK,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC,MAAM,GAAG,GAAG,IAAI,MAAM,EAAE,CAAC,CAAC,GAAG,IAC5D,CAAC,CACE,CACF,EACN;AACJ;;;;"}