{"version":3,"file":"index.es.js","sources":["../src/useFps.ts","../src/FpsView.tsx","../src/useStyles.ts"],"sourcesContent":["import {useEffect, useRef, useState} from \"react\";\n\nexport default function useFps(windowWidth: number) {\n  const lastFpsValues = useRef<number[]>([]);\n  const frames = useRef(0);\n  const prevTime = useRef(performance.now());\n  const animRef = useRef(0);\n  const [fps, setFps] = useState<number[]>([]);\n\n  const calcFps = () => {\n    const t = performance.now();\n\n    frames.current += 1;\n\n    if (t > prevTime.current + 1000) {\n      const elapsedTime = t - prevTime.current;\n\n      const currentFps = Math.round((frames.current * 1000) / elapsedTime);\n\n      lastFpsValues.current = lastFpsValues.current.concat(currentFps);\n\n      if (elapsedTime > 1500) {\n        for (let i = 1; i <= (elapsedTime - 1000) / 1000; i++) {\n          lastFpsValues.current = lastFpsValues.current.concat(0);\n        }\n      }\n\n      lastFpsValues.current = lastFpsValues.current.slice(Math.max(lastFpsValues.current.length - windowWidth, 0));\n\n      setFps(lastFpsValues.current);\n\n      frames.current = 0;\n      prevTime.current = performance.now();\n    }\n\n    animRef.current = requestAnimationFrame(calcFps);\n  };\n\n  useEffect(() => {\n    animRef.current = requestAnimationFrame(calcFps);\n\n    return () => {\n      cancelAnimationFrame(animRef.current);\n    }\n  }, []);\n\n  const avgFps = (fps.reduce((a,b) => a + b, 0) / fps.length).toFixed(2);\n  const maxFps = Math.max.apply(Math.max, fps);\n  const currentFps = fps[fps.length - 1];\n\n  return {fps, avgFps, maxFps, currentFps};\n}","import React from \"react\";\nimport useFps from \"./useFps\";\nimport useStyles from \"./useStyles\";\n\ninterface ComponentProps {\n  width?: number;\n  height?: number;\n  top?: number | string;\n  left?: number | string;\n  bottom?: number | string;\n  right?: number | string;\n}\n\nconst FpsView: React.FC<ComponentProps> = ({top = 0, left = 0, bottom = 'auto', right = 'auto', width = 140, height = 60}) => {\n  const {fps, avgFps, maxFps, currentFps} = useFps(Math.floor(width / 2));\n  const {graphStyle, barStyle, wrapperStyle} = useStyles(width, height, top, right, bottom, left, fps.length);\n\n  return (\n    // @ts-ignore\n    <div style={wrapperStyle}>\n      <span>{currentFps} FPS ({avgFps} Avg)</span>\n      {/* @ts-ignore */}\n      <div style={graphStyle}>\n        {fps.map((val, i) => (\n          // @ts-ignore\n          <div key={i} style={barStyle((height * val) / maxFps, i)}/>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default FpsView;\n","import {useCallback, useMemo} from \"react\";\n\ntype CssProp = number | string;\n\nexport default function useStyles(width: number, height: number, top: CssProp, right: CssProp, bottom: CssProp, left: CssProp, fpsLength: number) {\n  const wrapperStyle = useMemo(() => ({\n    zIndex: 999999,\n    position: 'fixed',\n    width: width + 6 + 'px',\n    height: height + 30 + 'px',\n    padding: '3px',\n    backgroundColor: '#21006f',\n    color: '#26F0FD',\n    fontSize: '1rem',\n    lineHeight: '1.3rem',\n    fontFamily: 'Helvetica, Arial, sans-serif',\n    fontWeight: 300,\n    boxSizing: 'border-box',\n    top,\n    right,\n    bottom,\n    left,\n  }), [width, height, top, right, bottom, left]);\n\n  const graphStyle = useMemo(() => ({\n    position: 'absolute',\n    left: '3px',\n    right: '3px',\n    bottom: '3px',\n    height,\n    backgroundColor: '#282844',\n    MozBoxSizing: 'border-box',\n    boxSizing: 'border-box'\n  }), [height]);\n\n  const barStyle = useCallback((calcHeight, i) => ({\n    position: 'absolute',\n    bottom: '0',\n    right: ((fpsLength - 1 - i) * 4) + 'px',\n    height: calcHeight + 'px',\n    width: '4px',\n    backgroundColor: '#E200F7',\n    MozBoxSizing: 'border-box',\n    boxSizing: 'border-box'\n  }), [fpsLength]);\n\n  return {wrapperStyle, graphStyle, barStyle};\n}"],"names":["useFps","windowWidth","lastFpsValues","useRef","frames","prevTime","performance","now","animRef","_a","useState","fps","setFps","calcFps","t","current","elapsedTime","currentFps_1","Math","round","concat","i","slice","max","length","requestAnimationFrame","useEffect","cancelAnimationFrame","avgFps","reduce","a","b","toFixed","maxFps","apply","currentFps","FpsView","_b","top","_c","left","_d","bottom","_e","right","_f","width","_g","height","_h","floor","_j","fpsLength","wrapperStyle","useMemo","zIndex","position","padding","backgroundColor","color","fontSize","lineHeight","fontFamily","fontWeight","boxSizing","graphStyle","MozBoxSizing","barStyle","useCallback","calcHeight","useStyles","React","style","map","val","key"],"mappings":"sGAEwBA,EAAOC,GAC7B,IAAMC,EAAgBC,EAAiB,IACjCC,EAASD,EAAO,GAChBE,EAAWF,EAAOG,YAAYC,OAC9BC,EAAUL,EAAO,GACjBM,EAAgBC,EAAmB,IAAlCC,OAAKC,OAENC,EAAU,WACd,IAAMC,EAAIR,YAAYC,MAItB,GAFAH,EAAOW,SAAW,EAEdD,EAAIT,EAASU,QAAU,IAAM,CAC/B,IAAMC,EAAcF,EAAIT,EAASU,QAE3BE,EAAaC,KAAKC,MAAwB,IAAjBf,EAAOW,QAAkBC,GAIxD,GAFAd,EAAca,QAAUb,EAAca,QAAQK,OAAOH,GAEjDD,EAAc,KAChB,IAAK,IAAIK,EAAI,EAAGA,IAAML,EAAc,KAAQ,IAAMK,IAChDnB,EAAca,QAAUb,EAAca,QAAQK,OAAO,GAIzDlB,EAAca,QAAUb,EAAca,QAAQO,MAAMJ,KAAKK,IAAIrB,EAAca,QAAQS,OAASvB,EAAa,IAEzGW,EAAOV,EAAca,SAErBX,EAAOW,QAAU,EACjBV,EAASU,QAAUT,YAAYC,MAGjCC,EAAQO,QAAUU,sBAAsBZ,IAG1Ca,GAAU,WAGR,OAFAlB,EAAQO,QAAUU,sBAAsBZ,GAEjC,WACLc,qBAAqBnB,EAAQO,YAE9B,IAEH,IAAMa,GAAUjB,EAAIkB,QAAO,SAACC,EAAEC,GAAM,OAAAD,EAAIC,IAAG,GAAKpB,EAAIa,QAAQQ,QAAQ,GAIpE,MAAO,CAACrB,MAAKiB,SAAQK,OAHNf,KAAKK,IAAIW,MAAMhB,KAAKK,IAAKZ,GAGXwB,WAFVxB,EAAIA,EAAIa,OAAS,QCnChCY,EAAoC,SAAC3B,OAAC4B,QAAAC,aAAM,IAAGC,SAAAC,aAAO,IAAGC,WAAAC,aAAS,SAAQC,UAAAC,aAAQ,SAAQC,UAAAC,aAAQ,MAAKC,WAAAC,aAAS,KAC9GC,EAAoCjD,EAAOkB,KAAKgC,MAAMJ,EAAQ,IAA7DnC,QAAKiB,WAAQK,WAAQE,eACtBgB,WCX0BL,EAAeE,EAAgBV,EAAcM,EAAgBF,EAAiBF,EAAeY,GA0C7H,MAAO,CAACC,aAzCaC,GAAQ,WAAM,OACjCC,OAAQ,OACRC,SAAU,QACVV,MAAOA,EAAQ,EAAI,KACnBE,OAAQA,EAAS,GAAK,KACtBS,QAAS,MACTC,gBAAiB,UACjBC,MAAO,UACPC,SAAU,OACVC,WAAY,SACZC,WAAY,+BACZC,WAAY,IACZC,UAAW,aACX1B,MACAM,QACAF,SACAF,UACE,CAACM,EAAOE,EAAQV,EAAKM,EAAOF,EAAQF,IAwBlByB,WAtBHX,GAAQ,WAAM,OAC/BE,SAAU,WACVhB,KAAM,MACNI,MAAO,MACPF,OAAQ,MACRM,SACAU,gBAAiB,UACjBQ,aAAc,aACdF,UAAW,gBACT,CAAChB,IAa6BmB,SAXjBC,GAAY,SAACC,EAAYhD,GAAM,OAC9CmC,SAAU,WACVd,OAAQ,IACRE,MAA8B,GAArBQ,EAAY,EAAI/B,GAAU,KACnC2B,OAAQqB,EAAa,KACrBvB,MAAO,MACPY,gBAAiB,UACjBQ,aAAc,aACdF,UAAW,gBACT,CAACZ,KD7BwCkB,CAAUxB,EAAOE,EAAQV,EAAKM,EAAOF,EAAQF,EAAM7B,EAAIa,QAA7FyC,eAAYE,aAAUd,iBAE7B,OAEEkB,uBAAKC,MAAOnB,GACVkB,4BAAOpC,WAAkBP,WAEzB2C,uBAAKC,MAAOP,GACTtD,EAAI8D,KAAI,SAACC,EAAKrD,GAAM,OAEnBkD,uBAAKI,IAAKtD,EAAGmD,MAAOL,EAAUnB,EAAS0B,EAAOzC,EAAQZ"}